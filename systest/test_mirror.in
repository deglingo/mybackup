# -*- shell-script -*-


# setup
#
test_mirror_setup()
{
	st_mkfile "/etc/mybackup/test/mybackup.conf" - <<EOF
{
  "scripts": {
    "mirror": {
      "prog": "./mirror",
      "options": ["%(config)s", "%(disk)s", "%(orig)s", "%(path)s", "%(vardir)s"]
    }
  },
  "disks": {
    "DISK_BOB": {
      "orig": "$ST_ROOTDIR/home/bob",
      "path": "$ST_ROOTDIR/mirror/bob",
      "hooks": [["schedule", "mirror"]]
    }
  }
}
EOF

	st_mkfile -m755 "/etc/mybackup/test/mirror" "@abs_top_builddir@/docs/examples/mirror"

	st_mkdir "/mirror/bob"
	st_mkdir "/home/bob"
	echo "FILE1" >st_mkfile "/home/bob/FILE1" -
	echo "FILE2" >st_mkfile "/home/bob/FILE2" -
	echo "FILE3" >st_mkfile "/home/bob/FILE3" -
}


# main
#
test_mirror_main()
{
	"$MBDUMP" test
}
